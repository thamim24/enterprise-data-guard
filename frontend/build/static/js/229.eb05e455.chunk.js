"use strict";(self.webpackChunkenterprise_data_guard_frontend=self.webpackChunkenterprise_data_guard_frontend||[]).push([[229],{229:(e,s,t)=>{t.r(s),t.d(s,{default:()=>l});var i=t(43),a=t(213),n=t(579);const r=e=>{let{alert:s,onResolve:t}=e;const i=e=>e>=.8?"#dc3545":e>=.6?"#fd7e14":e>=.4?"#ffc107":"#28a745";return(0,n.jsx)("div",{className:"card",style:{marginBottom:"15px",borderLeft:`5px solid ${i(s.risk_score)}`,background:s.risk_score>=.7?"#fff5f5":"#f8f9fa"},children:(0,n.jsxs)("div",{style:{padding:"15px"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,n.jsxs)("div",{style:{flex:1},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px"},children:[(0,n.jsx)("span",{style:{fontSize:"20px",marginRight:"10px"},children:(e=>{switch(e){case"unauthorized_access":return"\ud83d\udea8";case"document_modified":return"\ud83d\udd04";case"suspicious_download":return"\ud83d\udce5";case"cross_department_access":return"\ud83d\udd12";case"data_leak_attempt":return"\ud83d\udca5";case"external_tampering":return"\u26a0\ufe0f";default:return"\ud83d\udd0d"}})(s.alert_type)}),(0,n.jsx)("h4",{style:{margin:0,color:"#333"},children:s.alert_type.replace(/_/g," ").toUpperCase()}),(0,n.jsxs)("span",{className:"risk-score "+(a=s.risk_score,a>=.7?"risk-high":a>=.4?"risk-medium":"risk-low"),style:{marginLeft:"15px",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",color:"white",background:i(s.risk_score)},children:[(e=>e>=.7?"HIGH":e>=.4?"MEDIUM":"LOW")(s.risk_score)," (",s.risk_score.toFixed(2),")"]})]}),(0,n.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,n.jsx)("strong",{children:"\ud83d\udc64 User:"})," ",s.username,s.department&&(0,n.jsxs)("span",{style:{color:"#666"},children:[" (",s.department,")"]})]}),s.document_name&&(0,n.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,n.jsx)("strong",{children:"\ud83d\udcc4 Document:"})," ",s.document_name]}),(0,n.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,n.jsx)("strong",{children:"\ud83d\udcdd Description:"}),(0,n.jsx)("span",{style:{color:"#555",marginLeft:"5px"},children:s.description})]}),(0,n.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,n.jsx)("strong",{children:"\u23f0 Time:"}),(0,n.jsx)("span",{style:{color:"#666",marginLeft:"5px"},children:new Date(s.timestamp).toLocaleString()})]}),(0,n.jsxs)("div",{style:{fontSize:"12px",color:"#888"},children:[(0,n.jsx)("strong",{children:"Status:"})," ",s.resolved?"\u2705 Resolved":"\ud83d\udd34 Active"]})]}),(0,n.jsx)("div",{style:{marginLeft:"20px"},children:!s.resolved&&t&&(0,n.jsx)("button",{className:"btn btn-success",onClick:()=>t(s.id),style:{padding:"8px 16px",fontSize:"14px",borderRadius:"4px"},children:"\u2705 Resolve"})})]}),s.risk_score>=.8&&(0,n.jsx)("div",{style:{marginTop:"10px",padding:"8px 12px",background:"#dc3545",color:"white",borderRadius:"4px",fontSize:"14px",fontWeight:"bold"},children:"\ud83d\udea8 CRITICAL THREAT - Immediate attention required!"})]})});var a},d=e=>{let{oldText:s,newText:t,fileName:a}=e;const[r,d]=(0,i.useState)("unified"),l=((e,s)=>{const t=e.split("\n"),i=s.split("\n"),a=[],n=Math.max(t.length,i.length);for(let r=0;r<n;r++){const e=t[r]||"",s=i[r]||"";e===s?a.push({type:"unchanged",oldLineNum:r+1,newLineNum:r+1,content:e}):e&&!s?a.push({type:"removed",oldLineNum:r+1,newLineNum:null,content:e}):(!e&&s||a.push({type:"removed",oldLineNum:r+1,newLineNum:null,content:e}),a.push({type:"added",oldLineNum:null,newLineNum:r+1,content:s}))}return a})(s,t),c=e=>{switch(e){case"added":return{backgroundColor:"#d4edda",borderLeft:"3px solid #28a745"};case"removed":return{backgroundColor:"#f8d7da",borderLeft:"3px solid #dc3545"};case"unchanged":return{backgroundColor:"#f8f9fa",borderLeft:"3px solid #dee2e6"};default:return{}}},o=e=>{switch(e){case"added":return"+";case"removed":return"-";default:return" "}},h={added:l.filter(e=>"added"===e.type).length,removed:l.filter(e=>"removed"===e.type).length,unchanged:l.filter(e=>"unchanged"===e.type).length};return(0,n.jsxs)("div",{style:{border:"1px solid #ddd",borderRadius:"8px",overflow:"hidden"},children:[(0,n.jsxs)("div",{style:{background:"#f8f9fa",padding:"15px",borderBottom:"1px solid #ddd",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("h4",{style:{margin:0,color:"#333"},children:["\ud83d\udcc4 ",a]}),(0,n.jsxs)("div",{style:{fontSize:"14px",color:"#666",marginTop:"5px"},children:[(0,n.jsxs)("span",{style:{color:"#28a745"},children:["+",h.added," additions"]})," | ",(0,n.jsxs)("span",{style:{color:"#dc3545"},children:["-",h.removed," deletions"]})," | ",(0,n.jsxs)("span",{style:{color:"#6c757d"},children:[h.unchanged," unchanged"]})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("button",{className:"btn "+("unified"===r?"btn-primary":"btn-secondary"),onClick:()=>d("unified"),style:{marginRight:"10px",fontSize:"12px",padding:"6px 12px"},children:"\ud83d\udcc4 Unified"}),(0,n.jsx)("button",{className:"btn "+("split"===r?"btn-primary":"btn-secondary"),onClick:()=>d("split"),style:{fontSize:"12px",padding:"6px 12px"},children:"\ud83d\udcca Split"})]})]}),(0,n.jsx)("div",{style:{maxHeight:"500px",overflow:"auto",background:"white"},children:"unified"===r?(0,n.jsx)("div",{style:{fontFamily:"monospace",fontSize:"14px"},children:l.map((e,s)=>(0,n.jsxs)("div",{style:{...c(e.type),padding:"2px 10px",display:"flex",alignItems:"center"},children:[(0,n.jsxs)("span",{style:{minWidth:"60px",color:"#666",fontSize:"12px",marginRight:"10px"},children:[e.oldLineNum||""," ",e.newLineNum||""]}),(0,n.jsx)("span",{style:{marginRight:"10px",fontWeight:"bold",color:"added"===e.type?"#28a745":"removed"===e.type?"#dc3545":"#6c757d"},children:o(e.type)}),(0,n.jsx)("span",{style:{whiteSpace:"pre-wrap",wordBreak:"break-all"},children:e.content})]},s))}):(0,n.jsxs)("div",{style:{display:"flex",fontFamily:"monospace",fontSize:"14px"},children:[(0,n.jsxs)("div",{style:{flex:1,borderRight:"1px solid #ddd"},children:[(0,n.jsx)("div",{style:{background:"#f8d7da",padding:"8px 12px",fontWeight:"bold",borderBottom:"1px solid #ddd"},children:"\ud83d\udcc4 Original"}),s.split("\n").map((e,s)=>(0,n.jsxs)("div",{style:{padding:"2px 10px",borderBottom:"1px solid #f0f0f0",background:"#fff",minHeight:"20px"},children:[(0,n.jsx)("span",{style:{color:"#666",marginRight:"10px",fontSize:"12px"},children:s+1}),(0,n.jsx)("span",{style:{whiteSpace:"pre-wrap"},children:e})]},s))]}),(0,n.jsxs)("div",{style:{flex:1},children:[(0,n.jsx)("div",{style:{background:"#d4edda",padding:"8px 12px",fontWeight:"bold",borderBottom:"1px solid #ddd"},children:"\ud83d\udcc4 Modified"}),t.split("\n").map((e,s)=>(0,n.jsxs)("div",{style:{padding:"2px 10px",borderBottom:"1px solid #f0f0f0",background:"#fff",minHeight:"20px"},children:[(0,n.jsx)("span",{style:{color:"#666",marginRight:"10px",fontSize:"12px"},children:s+1}),(0,n.jsx)("span",{style:{whiteSpace:"pre-wrap"},children:e})]},s))]})]})}),(0,n.jsx)("div",{style:{background:"#f8f9fa",padding:"10px 15px",borderTop:"1px solid #ddd",fontSize:"12px",color:"#666"},children:(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,n.jsxs)("span",{children:["\ud83d\udd0d Change Impact: ",((h.added+h.removed)/(h.added+h.removed+h.unchanged)*100).toFixed(1),"% of document modified"]}),(0,n.jsxs)("span",{children:["\ud83d\udcca Total Lines: ",h.added+h.removed+h.unchanged]})]})})]})};t(767);const l=e=>{let{user:s,onLogout:t}=e;const[l,c]=(0,i.useState)(null),[o,h]=(0,i.useState)(!0),[x,m]=(0,i.useState)(""),[p,j]=(0,i.useState)("overview"),[g,u]=(0,i.useState)([]),[f,v]=(0,i.useState)([]),[y,b]=(0,i.useState)(null),k=async()=>{try{const e=localStorage.getItem("token"),s=await a.A.get("http://localhost:8000/api/admin/dashboard",{headers:{Authorization:`Bearer ${e}`}});c(s.data)}catch(x){m("Failed to fetch dashboard data"),console.error(x)}finally{h(!1)}},N=async()=>{try{const e=localStorage.getItem("token"),s=await a.A.get("http://localhost:8000/api/admin/modifications",{headers:{Authorization:`Bearer ${e}`}});u(s.data.modifications||[])}catch(x){console.error("Failed to fetch modifications:",x)}},_=async()=>{try{const e=localStorage.getItem("token"),s=await a.A.get("http://localhost:8000/api/admin/data-leaks",{headers:{Authorization:`Bearer ${e}`}});v(s.data.attempts||[])}catch(x){console.error("Failed to fetch data leak attempts:",x)}};(0,i.useEffect)(()=>{k(),N(),_();const e=setInterval(()=>{k(),N(),_()},3e4);return()=>clearInterval(e)},[]);const S=async e=>{try{const s=localStorage.getItem("token");await a.A.post(`http://localhost:8000/api/admin/access-logs/${e}/resolve`,{},{headers:{Authorization:`Bearer ${s}`}}),alert("Alert resolved successfully"),k()}catch(x){var s,t;console.error("Resolve error:",x),alert("Failed to resolve alert: "+((null===(s=x.response)||void 0===s||null===(t=s.data)||void 0===t?void 0:t.detail)||"Unknown error"))}},w=e=>e>=.7?"risk-high":e>=.4?"risk-medium":"risk-low",L=e=>e>=.7?"HIGH":e>=.4?"MEDIUM":"LOW";return o?(0,n.jsx)("div",{className:"loading",children:"Loading admin dashboard"}):(0,n.jsxs)("div",{children:[(0,n.jsxs)("nav",{className:"navbar",children:[(0,n.jsx)("h1",{children:"Enterprise Data Guard"}),(0,n.jsxs)("div",{className:"user-info",children:[(0,n.jsxs)("span",{children:[s.username," (Administrator)"]}),(0,n.jsx)("button",{className:"btn btn-success",onClick:async()=>{try{const e=localStorage.getItem("token"),s=await a.A.get("http://localhost:8000/api/admin/reports/generate?days=7&format=pdf",{headers:{Authorization:`Bearer ${e}`}});s.data.download_url&&window.open(`http://localhost:8000${s.data.download_url}`,"_blank"),alert("Security report generated successfully!")}catch(x){alert("Failed to generate report")}},children:"Generate Report"}),(0,n.jsx)("button",{className:"btn btn-danger",onClick:t,children:"Logout"})]})]}),(0,n.jsxs)("div",{className:"container",children:[x&&(0,n.jsx)("div",{className:"alert alert-danger",children:x}),l&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"metrics-grid",children:[(0,n.jsxs)("div",{className:"metric-card alerts",children:[(0,n.jsx)("h3",{children:"Active Alerts"}),(0,n.jsx)("div",{className:"metric-value",children:l.summary.total_alerts}),(0,n.jsx)("div",{className:"metric-label",children:"Security incidents"})]}),(0,n.jsxs)("div",{className:"metric-card critical",children:[(0,n.jsx)("h3",{children:"High Risk"}),(0,n.jsx)("div",{className:"metric-value",children:l.summary.high_risk_alerts}),(0,n.jsx)("div",{className:"metric-label",children:"Critical threats"})]}),(0,n.jsxs)("div",{className:"metric-card info",children:[(0,n.jsx)("h3",{children:"Modifications"}),(0,n.jsx)("div",{className:"metric-value",children:g.length}),(0,n.jsx)("div",{className:"metric-label",children:"Document changes"})]}),(0,n.jsxs)("div",{className:"metric-card alerts",children:[(0,n.jsx)("h3",{children:"Data Leaks"}),(0,n.jsx)("div",{className:"metric-value",children:f.length}),(0,n.jsx)("div",{className:"metric-label",children:"Unauthorized access"})]}),(0,n.jsxs)("div",{className:"metric-card success",children:[(0,n.jsx)("h3",{children:"Access Events"}),(0,n.jsx)("div",{className:"metric-value",children:l.summary.recent_access}),(0,n.jsx)("div",{className:"metric-label",children:"Total activities"})]}),(0,n.jsxs)("div",{className:"metric-card neutral",children:[(0,n.jsx)("h3",{children:"Anomalies"}),(0,n.jsx)("div",{className:"metric-value",children:l.summary.anomalous_activities}),(0,n.jsx)("div",{className:"metric-label",children:"Suspicious behavior"})]})]}),(0,n.jsxs)("div",{className:"card",children:[(0,n.jsx)("div",{className:"tab-navigation",children:[{key:"overview",label:"Overview"},{key:"alerts",label:"Security Alerts"},{key:"tampering",label:"Document Changes"},{key:"data-leaks",label:"Data Leak Attempts"},{key:"access",label:"Access Logs"}].map(e=>(0,n.jsx)("button",{className:"tab-button "+(p===e.key?"active":""),onClick:()=>j(e.key),children:e.label},e.key))}),"overview"===p&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{children:"Security Overview"}),(0,n.jsxs)("div",{className:"content-grid",children:[(0,n.jsxs)("div",{className:"summary-section",children:[(0,n.jsx)("h4",{children:"Threat Summary"}),(0,n.jsxs)("ul",{style:{listStyle:"none",padding:0},children:[(0,n.jsxs)("li",{style:{padding:"5px 0",borderBottom:"1px solid #eee"},children:["Active Alerts: ",(0,n.jsx)("strong",{children:l.summary.total_alerts})]}),(0,n.jsxs)("li",{style:{padding:"5px 0",borderBottom:"1px solid #eee"},children:["High Risk Events: ",(0,n.jsx)("strong",{children:l.summary.high_risk_alerts})]}),(0,n.jsxs)("li",{style:{padding:"5px 0",borderBottom:"1px solid #eee"},children:["Document Tampering: ",(0,n.jsx)("strong",{children:g.filter(e=>"content_modification"===e.modification_type).length})]}),(0,n.jsxs)("li",{style:{padding:"5px 0",borderBottom:"1px solid #eee"},children:["Data Leak Attempts: ",(0,n.jsx)("strong",{children:f.length})]}),(0,n.jsxs)("li",{style:{padding:"5px 0"},children:["Anomalous Behavior: ",(0,n.jsx)("strong",{children:l.summary.anomalous_activities})]})]})]}),(0,n.jsxs)("div",{className:"summary-section",children:[(0,n.jsx)("h4",{children:"System Health"}),(0,n.jsxs)("div",{style:{padding:"15px"},children:[(0,n.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,n.jsx)("strong",{children:"Status:"}),(0,n.jsx)("span",{className:"status-badge status-normal",style:{marginLeft:"10px"},children:"Operational"})]}),(0,n.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,n.jsx)("strong",{children:"Last Update:"}),(0,n.jsx)("span",{style:{marginLeft:"10px"},children:(new Date).toLocaleString()})]}),(0,n.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,n.jsx)("strong",{children:"Protection Level:"}),(0,n.jsx)("span",{style:{color:"#3182ce",marginLeft:"10px"},children:"Maximum"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Monitoring:"}),(0,n.jsx)("span",{className:"status-badge status-normal",style:{marginLeft:"10px"},children:"Active"})]})]})]})]})]}),"alerts"===p&&(0,n.jsxs)("div",{className:l.alerts.length>0?"alerts-section danger":"alerts-section safe",children:[(0,n.jsxs)("h3",{children:["Security Alerts (",l.alerts.length,")"]}),0===l.alerts.length?(0,n.jsx)("div",{className:"alert alert-success",children:"No active security alerts. System is secure."}):(0,n.jsx)("div",{children:l.alerts.map(e=>(0,n.jsx)(r,{alert:e,onResolve:()=>S(e.id)},e.id))})]}),"tampering"===p&&(0,n.jsxs)("div",{children:[(0,n.jsxs)("h3",{children:["Document Modification Analysis (",g.length,")"]}),0===g.length?(0,n.jsx)("div",{className:"alert alert-info",children:"No document modifications detected."}):(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"summary-section",children:[(0,n.jsx)("h4",{children:"Modification Summary"}),(0,n.jsxs)("div",{className:"content-grid",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Total Modifications:"})," ",g.length]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Today:"})," ",g.filter(e=>new Date(e.timestamp).toDateString()===(new Date).toDateString()).length]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"High Impact:"})," ",g.filter(e=>JSON.parse(e.diff_stats||"{}").change_percentage>50).length]})]})]}),(0,n.jsxs)("table",{className:"table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Document"}),(0,n.jsx)("th",{children:"Modified By"}),(0,n.jsx)("th",{children:"Changes"}),(0,n.jsx)("th",{children:"Time"}),(0,n.jsx)("th",{children:"Actions"})]})}),(0,n.jsx)("tbody",{children:g.map(e=>{var s;const t=JSON.parse(e.diff_stats||"{}");return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:e.document_name}),(0,n.jsx)("td",{children:e.username}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{style:{fontSize:"12px"},children:[(0,n.jsxs)("span",{style:{color:"#38a169"},children:["+",t.added_lines||0]})," / ",(0,n.jsxs)("span",{style:{color:"#e53e3e"},children:["-",t.removed_lines||0]}),(0,n.jsx)("br",{}),(0,n.jsxs)("small",{children:[(null===(s=t.change_percentage)||void 0===s?void 0:s.toFixed(1))||0,"% changed"]})]})}),(0,n.jsx)("td",{children:new Date(e.timestamp).toLocaleString()}),(0,n.jsx)("td",{children:(0,n.jsx)("button",{className:"btn btn-small",onClick:()=>(async e=>{try{const s=localStorage.getItem("token"),t=await a.A.get(`http://localhost:8000/api/admin/modification-diff/${e.id}`,{headers:{Authorization:`Bearer ${s}`}});b({...e,diffData:t.data})}catch(x){alert("Failed to fetch modification details")}})(e),children:"View Diff"})})]},e.id)})})]})]}),y&&(0,n.jsx)("div",{className:"modal-overlay",children:(0,n.jsxs)("div",{className:"modal-content",children:[(0,n.jsxs)("div",{className:"modal-header",children:[(0,n.jsx)("h3",{children:"Document Modification Details"}),(0,n.jsx)("button",{className:"btn btn-danger",onClick:()=>b(null),children:"Close"})]}),(0,n.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Document:"})," ",y.document_name]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Modified by:"})," ",y.username]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Time:"})," ",new Date(y.timestamp).toLocaleString()]})]}),y.diffData&&(0,n.jsx)(d,{oldText:y.diffData.old_content,newText:y.diffData.new_content,fileName:y.document_name})]})})]}),"data-leaks"===p&&(0,n.jsxs)("div",{children:[(0,n.jsxs)("h3",{children:["Data Leak Attempts Analysis (",f.length,")"]}),0===f.length?(0,n.jsx)("div",{className:"alert alert-success",children:"No data leak attempts detected. Security is strong."}):(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"summary-section",children:[(0,n.jsx)("h4",{children:"Leak Attempt Summary"}),(0,n.jsxs)("div",{className:"content-grid",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Total Attempts:"})," ",f.length]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Blocked:"})," ",f.filter(e=>e.blocked).length]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"High Risk:"})," ",f.filter(e=>e.risk_score>=.8).length]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Today:"})," ",f.filter(e=>new Date(e.timestamp).toDateString()===(new Date).toDateString()).length]})]})]}),(0,n.jsxs)("table",{className:"table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"User"}),(0,n.jsx)("th",{children:"Target Dept"}),(0,n.jsx)("th",{children:"Document"}),(0,n.jsx)("th",{children:"Action"}),(0,n.jsx)("th",{children:"Risk"}),(0,n.jsx)("th",{children:"Status"}),(0,n.jsx)("th",{children:"Time"})]})}),(0,n.jsx)("tbody",{children:f.map(e=>(0,n.jsxs)("tr",{style:{background:e.risk_score>=.8?"#fff5f5":"transparent"},children:[(0,n.jsx)("td",{children:e.username}),(0,n.jsx)("td",{children:(0,n.jsx)("span",{className:"dept-badge",children:e.target_department})}),(0,n.jsx)("td",{children:e.document_name}),(0,n.jsx)("td",{children:(0,n.jsx)("span",{className:"action-badge",children:e.action_attempted})}),(0,n.jsx)("td",{children:(0,n.jsx)("span",{className:`risk-score ${w(e.risk_score)}`,children:L(e.risk_score)})}),(0,n.jsx)("td",{children:e.blocked?(0,n.jsx)("span",{className:"status-badge status-blocked",children:"BLOCKED"}):(0,n.jsx)("span",{className:"status-badge status-allowed",children:"ALLOWED"})}),(0,n.jsx)("td",{children:new Date(e.timestamp).toLocaleString()})]},e.id))})]})]})]}),"access"===p&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{children:"Recent Access Logs"}),0===l.recent_access.length?(0,n.jsx)("p",{children:"No recent access logs."}):(0,n.jsxs)("table",{className:"table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"User"}),(0,n.jsx)("th",{children:"Document"}),(0,n.jsx)("th",{children:"Action"}),(0,n.jsx)("th",{children:"Time"}),(0,n.jsx)("th",{children:"Risk Score"}),(0,n.jsx)("th",{children:"Status"})]})}),(0,n.jsx)("tbody",{children:l.recent_access.map(e=>(0,n.jsxs)("tr",{style:{background:e.anomaly_flag?"#fff3cd":"transparent"},children:[(0,n.jsxs)("td",{children:[e.username," (",e.department,")"]}),(0,n.jsx)("td",{children:e.document_name||"N/A"}),(0,n.jsx)("td",{children:(0,n.jsx)("span",{className:`action-badge action-${e.action}`,children:e.action.toUpperCase()})}),(0,n.jsx)("td",{children:new Date(e.timestamp).toLocaleString()}),(0,n.jsx)("td",{children:(0,n.jsxs)("span",{className:`risk-score ${w(e.risk_score)}`,children:[L(e.risk_score)," (",e.risk_score.toFixed(2),")"]})}),(0,n.jsx)("td",{children:e.anomaly_flag?(0,n.jsx)("span",{className:"status-badge status-anomalous",children:"Anomalous"}):(0,n.jsx)("span",{className:"status-badge status-normal",children:"Normal"})})]},e.id))})]})]})]})]})]})]})}},767:()=>{}}]);
//# sourceMappingURL=229.eb05e455.chunk.js.map