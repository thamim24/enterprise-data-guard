"use strict";(self.webpackChunkenterprise_data_guard_frontend=self.webpackChunkenterprise_data_guard_frontend||[]).push([[229],{229:(e,t,s)=>{s.r(t),s.d(t,{default:()=>l});var n=s(43),i=s(213),r=s(579);const d=e=>{let{alert:t,onResolve:s}=e;const n=e=>e>=.8?"#dc3545":e>=.6?"#fd7e14":e>=.4?"#ffc107":"#28a745";return(0,r.jsx)("div",{className:"card",style:{marginBottom:"15px",borderLeft:`5px solid ${n(t.risk_score)}`,background:t.risk_score>=.7?"#fff5f5":"#f8f9fa"},children:(0,r.jsxs)("div",{style:{padding:"15px"},children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,r.jsxs)("div",{style:{flex:1},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px"},children:[(0,r.jsx)("span",{style:{fontSize:"20px",marginRight:"10px"},children:(e=>{switch(e){case"unauthorized_access":return"\ud83d\udea8";case"document_modified":return"\ud83d\udd04";case"suspicious_download":return"\ud83d\udce5";case"cross_department_access":return"\ud83d\udd12";case"data_leak_attempt":return"\ud83d\udca5";case"external_tampering":return"\u26a0\ufe0f";default:return"\ud83d\udd0d"}})(t.alert_type)}),(0,r.jsx)("h4",{style:{margin:0,color:"#333"},children:t.alert_type.replace(/_/g," ").toUpperCase()}),(0,r.jsxs)("span",{className:"risk-score "+(i=t.risk_score,i>=.7?"risk-high":i>=.4?"risk-medium":"risk-low"),style:{marginLeft:"15px",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",color:"white",background:n(t.risk_score)},children:[(e=>e>=.7?"HIGH":e>=.4?"MEDIUM":"LOW")(t.risk_score)," (",t.risk_score.toFixed(2),")"]})]}),(0,r.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,r.jsx)("strong",{children:"\ud83d\udc64 User:"})," ",t.username,t.department&&(0,r.jsxs)("span",{style:{color:"#666"},children:[" (",t.department,")"]})]}),t.document_name&&(0,r.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,r.jsx)("strong",{children:"\ud83d\udcc4 Document:"})," ",t.document_name]}),(0,r.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,r.jsx)("strong",{children:"\ud83d\udcdd Description:"}),(0,r.jsx)("span",{style:{color:"#555",marginLeft:"5px"},children:t.description})]}),(0,r.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,r.jsx)("strong",{children:"\u23f0 Time:"}),(0,r.jsx)("span",{style:{color:"#666",marginLeft:"5px"},children:new Date(t.timestamp).toLocaleString()})]}),(0,r.jsxs)("div",{style:{fontSize:"12px",color:"#888"},children:[(0,r.jsx)("strong",{children:"Status:"})," ",t.resolved?"\u2705 Resolved":"\ud83d\udd34 Active"]})]}),(0,r.jsx)("div",{style:{marginLeft:"20px"},children:!t.resolved&&s&&(0,r.jsx)("button",{className:"btn btn-success",onClick:()=>s(t.id),style:{padding:"8px 16px",fontSize:"14px",borderRadius:"4px"},children:"\u2705 Resolve"})})]}),t.risk_score>=.8&&(0,r.jsx)("div",{style:{marginTop:"10px",padding:"8px 12px",background:"#dc3545",color:"white",borderRadius:"4px",fontSize:"14px",fontWeight:"bold"},children:"\ud83d\udea8 CRITICAL THREAT - Immediate attention required!"})]})});var i},a=e=>{let{oldText:t,newText:s,fileName:i}=e;const[d,a]=(0,n.useState)("unified"),l=((e,t)=>{const s=e.split("\n"),n=t.split("\n"),i=[],r=Math.max(s.length,n.length);for(let d=0;d<r;d++){const e=s[d]||"",t=n[d]||"";e===t?i.push({type:"unchanged",oldLineNum:d+1,newLineNum:d+1,content:e}):e&&!t?i.push({type:"removed",oldLineNum:d+1,newLineNum:null,content:e}):(!e&&t||i.push({type:"removed",oldLineNum:d+1,newLineNum:null,content:e}),i.push({type:"added",oldLineNum:null,newLineNum:d+1,content:t}))}return i})(t,s),o=e=>{switch(e){case"added":return{backgroundColor:"#d4edda",borderLeft:"3px solid #28a745"};case"removed":return{backgroundColor:"#f8d7da",borderLeft:"3px solid #dc3545"};case"unchanged":return{backgroundColor:"#f8f9fa",borderLeft:"3px solid #dee2e6"};default:return{}}},c=e=>{switch(e){case"added":return"+";case"removed":return"-";default:return" "}},h={added:l.filter(e=>"added"===e.type).length,removed:l.filter(e=>"removed"===e.type).length,unchanged:l.filter(e=>"unchanged"===e.type).length};return(0,r.jsxs)("div",{style:{border:"1px solid #ddd",borderRadius:"8px",overflow:"hidden"},children:[(0,r.jsxs)("div",{style:{background:"#f8f9fa",padding:"15px",borderBottom:"1px solid #ddd",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{style:{margin:0,color:"#333"},children:["\ud83d\udcc4 ",i]}),(0,r.jsxs)("div",{style:{fontSize:"14px",color:"#666",marginTop:"5px"},children:[(0,r.jsxs)("span",{style:{color:"#28a745"},children:["+",h.added," additions"]})," | ",(0,r.jsxs)("span",{style:{color:"#dc3545"},children:["-",h.removed," deletions"]})," | ",(0,r.jsxs)("span",{style:{color:"#6c757d"},children:[h.unchanged," unchanged"]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("button",{className:"btn "+("unified"===d?"btn-primary":"btn-secondary"),onClick:()=>a("unified"),style:{marginRight:"10px",fontSize:"12px",padding:"6px 12px"},children:"\ud83d\udcc4 Unified"}),(0,r.jsx)("button",{className:"btn "+("split"===d?"btn-primary":"btn-secondary"),onClick:()=>a("split"),style:{fontSize:"12px",padding:"6px 12px"},children:"\ud83d\udcca Split"})]})]}),(0,r.jsx)("div",{style:{maxHeight:"500px",overflow:"auto",background:"white"},children:"unified"===d?(0,r.jsx)("div",{style:{fontFamily:"monospace",fontSize:"14px"},children:l.map((e,t)=>(0,r.jsxs)("div",{style:{...o(e.type),padding:"2px 10px",display:"flex",alignItems:"center"},children:[(0,r.jsxs)("span",{style:{minWidth:"60px",color:"#666",fontSize:"12px",marginRight:"10px"},children:[e.oldLineNum||""," ",e.newLineNum||""]}),(0,r.jsx)("span",{style:{marginRight:"10px",fontWeight:"bold",color:"added"===e.type?"#28a745":"removed"===e.type?"#dc3545":"#6c757d"},children:c(e.type)}),(0,r.jsx)("span",{style:{whiteSpace:"pre-wrap",wordBreak:"break-all"},children:e.content})]},t))}):(0,r.jsxs)("div",{style:{display:"flex",fontFamily:"monospace",fontSize:"14px"},children:[(0,r.jsxs)("div",{style:{flex:1,borderRight:"1px solid #ddd"},children:[(0,r.jsx)("div",{style:{background:"#f8d7da",padding:"8px 12px",fontWeight:"bold",borderBottom:"1px solid #ddd"},children:"\ud83d\udcc4 Original"}),t.split("\n").map((e,t)=>(0,r.jsxs)("div",{style:{padding:"2px 10px",borderBottom:"1px solid #f0f0f0",background:"#fff",minHeight:"20px"},children:[(0,r.jsx)("span",{style:{color:"#666",marginRight:"10px",fontSize:"12px"},children:t+1}),(0,r.jsx)("span",{style:{whiteSpace:"pre-wrap"},children:e})]},t))]}),(0,r.jsxs)("div",{style:{flex:1},children:[(0,r.jsx)("div",{style:{background:"#d4edda",padding:"8px 12px",fontWeight:"bold",borderBottom:"1px solid #ddd"},children:"\ud83d\udcc4 Modified"}),s.split("\n").map((e,t)=>(0,r.jsxs)("div",{style:{padding:"2px 10px",borderBottom:"1px solid #f0f0f0",background:"#fff",minHeight:"20px"},children:[(0,r.jsx)("span",{style:{color:"#666",marginRight:"10px",fontSize:"12px"},children:t+1}),(0,r.jsx)("span",{style:{whiteSpace:"pre-wrap"},children:e})]},t))]})]})}),(0,r.jsx)("div",{style:{background:"#f8f9fa",padding:"10px 15px",borderTop:"1px solid #ddd",fontSize:"12px",color:"#666"},children:(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsxs)("span",{children:["\ud83d\udd0d Change Impact: ",((h.added+h.removed)/(h.added+h.removed+h.unchanged)*100).toFixed(1),"% of document modified"]}),(0,r.jsxs)("span",{children:["\ud83d\udcca Total Lines: ",h.added+h.removed+h.unchanged]})]})})]})},l=e=>{let{user:t,onLogout:s}=e;const[l,o]=(0,n.useState)(null),[c,h]=(0,n.useState)(!0),[x,p]=(0,n.useState)(""),[m,g]=(0,n.useState)("overview"),[j,f]=(0,n.useState)([]),[u,y]=(0,n.useState)([]),[b,v]=(0,n.useState)(null),k=async()=>{try{const e=localStorage.getItem("token"),t=await i.A.get("http://localhost:8000/api/admin/dashboard",{headers:{Authorization:`Bearer ${e}`}});o(t.data)}catch(x){p("Failed to fetch dashboard data"),console.error(x)}finally{h(!1)}},S=async()=>{try{const e=localStorage.getItem("token"),t=await i.A.get("http://localhost:8000/api/admin/modifications",{headers:{Authorization:`Bearer ${e}`}});f(t.data.modifications||[])}catch(x){console.error("Failed to fetch modifications:",x)}},_=async()=>{try{const e=localStorage.getItem("token"),t=await i.A.get("http://localhost:8000/api/admin/data-leaks",{headers:{Authorization:`Bearer ${e}`}});y(t.data.attempts||[])}catch(x){console.error("Failed to fetch data leak attempts:",x)}};(0,n.useEffect)(()=>{k(),S(),_();const e=setInterval(()=>{k(),S(),_()},3e4);return()=>clearInterval(e)},[]);const w=async e=>{try{const t=localStorage.getItem("token");await i.A.post(`http://localhost:8000/api/admin/alerts/${e}/resolve`,{},{headers:{Authorization:`Bearer ${t}`}}),k()}catch(x){alert("Failed to resolve alert")}},N=e=>e>=.7?"risk-high":e>=.4?"risk-medium":"risk-low",A=e=>e>=.7?"HIGH":e>=.4?"MEDIUM":"LOW";return c?(0,r.jsx)("div",{children:"Loading admin dashboard..."}):(0,r.jsxs)("div",{children:[(0,r.jsxs)("nav",{className:"navbar",children:[(0,r.jsx)("h1",{children:"\ud83d\udee1\ufe0f Enterprise Data Guard"}),(0,r.jsxs)("div",{className:"user-info",children:[(0,r.jsxs)("span",{children:["\ud83d\udc68\u200d\ud83d\udcbc ",t.username," (Administrator)"]}),(0,r.jsx)("button",{className:"btn btn-success",onClick:async()=>{try{const e=localStorage.getItem("token"),t=await i.A.get("http://localhost:8000/api/admin/reports/generate?days=7",{headers:{Authorization:`Bearer ${e}`}});t.data.download_url&&window.open(`http://localhost:8000${t.data.download_url}`,"_blank"),alert("Security report generated successfully!")}catch(x){alert("Failed to generate report")}},children:"\ud83d\udcca Generate Report"}),(0,r.jsx)("button",{className:"btn btn-danger",onClick:s,children:"Logout"})]})]}),(0,r.jsxs)("div",{className:"container",children:[x&&(0,r.jsx)("div",{className:"alert alert-danger",children:x}),l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(6, 1fr)",gap:"15px",marginBottom:"25px"},children:[(0,r.jsxs)("div",{className:"card",style:{textAlign:"center",background:"#fff3cd",border:"2px solid #ffc107"},children:[(0,r.jsx)("h3",{style:{margin:"0 0 5px 0",color:"#856404",fontSize:"0.9em"},children:"\ud83d\udea8 Active Alerts"}),(0,r.jsx)("h1",{style:{margin:"0",color:"#856404",fontSize:"2em"},children:l.summary.total_alerts}),(0,r.jsx)("small",{children:"Security incidents"})]}),(0,r.jsxs)("div",{className:"card",style:{textAlign:"center",background:"#f8d7da",border:"2px solid #dc3545"},children:[(0,r.jsx)("h3",{style:{margin:"0 0 5px 0",color:"#721c24",fontSize:"0.9em"},children:"\u26a0\ufe0f High Risk"}),(0,r.jsx)("h1",{style:{margin:"0",color:"#721c24",fontSize:"2em"},children:l.summary.high_risk_alerts}),(0,r.jsx)("small",{children:"Critical threats"})]}),(0,r.jsxs)("div",{className:"card",style:{textAlign:"center",background:"#d1ecf1",border:"2px solid #17a2b8"},children:[(0,r.jsx)("h3",{style:{margin:"0 0 5px 0",color:"#0c5460",fontSize:"0.9em"},children:"\ud83d\udd04 Modifications"}),(0,r.jsx)("h1",{style:{margin:"0",color:"#0c5460",fontSize:"2em"},children:j.length}),(0,r.jsx)("small",{children:"Document changes"})]}),(0,r.jsxs)("div",{className:"card",style:{textAlign:"center",background:"#ffeaa7",border:"2px solid #fd7e14"},children:[(0,r.jsx)("h3",{style:{margin:"0 0 5px 0",color:"#8b4513",fontSize:"0.9em"},children:"\ud83d\udea8 Data Leaks"}),(0,r.jsx)("h1",{style:{margin:"0",color:"#8b4513",fontSize:"2em"},children:u.length}),(0,r.jsx)("small",{children:"Unauthorized access"})]}),(0,r.jsxs)("div",{className:"card",style:{textAlign:"center",background:"#d4edda",border:"2px solid #28a745"},children:[(0,r.jsx)("h3",{style:{margin:"0 0 5px 0",color:"#155724",fontSize:"0.9em"},children:"\ud83d\udcca Access Events"}),(0,r.jsx)("h1",{style:{margin:"0",color:"#155724",fontSize:"2em"},children:l.summary.recent_access}),(0,r.jsx)("small",{children:"Total activities"})]}),(0,r.jsxs)("div",{className:"card",style:{textAlign:"center",background:"#e2e3e5",border:"2px solid #6c757d"},children:[(0,r.jsx)("h3",{style:{margin:"0 0 5px 0",color:"#495057",fontSize:"0.9em"},children:"\ud83d\udd0d Anomalies"}),(0,r.jsx)("h1",{style:{margin:"0",color:"#495057",fontSize:"2em"},children:l.summary.anomalous_activities}),(0,r.jsx)("small",{children:"Suspicious behavior"})]})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("div",{style:{borderBottom:"2px solid #ddd",marginBottom:"20px",padding:"10px 0"},children:[{key:"overview",label:"\ud83d\udccb Overview",icon:"\ud83d\udcca"},{key:"alerts",label:"\ud83d\udea8 Security Alerts",icon:"\u26a0\ufe0f"},{key:"tampering",label:"\ud83d\udd04 Document Changes",icon:"\ud83d\udcdd"},{key:"data-leaks",label:"\ud83d\udea8 Data Leak Attempts",icon:"\ud83d\udd12"},{key:"access",label:"\ud83d\udcc8 Access Logs",icon:"\ud83d\udccb"}].map(e=>(0,r.jsx)("button",{className:"btn",onClick:()=>g(e.key),style:{marginRight:"10px",marginBottom:"5px",background:m===e.key?"#007bff":"#6c757d",transform:m===e.key?"scale(1.05)":"scale(1)",transition:"all 0.2s"},children:e.label},e.key))}),"overview"===m&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{children:"\ud83c\udfaf Security Overview"}),(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(350px, 1fr))",gap:"20px"},children:[(0,r.jsxs)("div",{className:"card",style:{background:"#f8f9fa"},children:[(0,r.jsx)("h4",{children:"\ud83d\udea8 Threat Summary"}),(0,r.jsxs)("ul",{style:{listStyle:"none",padding:0},children:[(0,r.jsxs)("li",{style:{padding:"5px 0",borderBottom:"1px solid #eee"},children:["\ud83d\udd34 Active Alerts: ",(0,r.jsx)("strong",{children:l.summary.total_alerts})]}),(0,r.jsxs)("li",{style:{padding:"5px 0",borderBottom:"1px solid #eee"},children:["\u26a0\ufe0f High Risk Events: ",(0,r.jsx)("strong",{children:l.summary.high_risk_alerts})]}),(0,r.jsxs)("li",{style:{padding:"5px 0",borderBottom:"1px solid #eee"},children:["\ud83d\udd04 Document Tampering: ",(0,r.jsx)("strong",{children:j.filter(e=>"content_modification"===e.modification_type).length})]}),(0,r.jsxs)("li",{style:{padding:"5px 0",borderBottom:"1px solid #eee"},children:["\ud83d\udea8 Data Leak Attempts: ",(0,r.jsx)("strong",{children:u.length})]}),(0,r.jsxs)("li",{style:{padding:"5px 0"},children:["\ud83d\udd0d Anomalous Behavior: ",(0,r.jsx)("strong",{children:l.summary.anomalous_activities})]})]})]}),(0,r.jsxs)("div",{className:"card",style:{background:"#f8f9fa"},children:[(0,r.jsx)("h4",{children:"\ud83d\udcc8 System Health"}),(0,r.jsxs)("div",{style:{padding:"15px"},children:[(0,r.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,r.jsx)("strong",{children:"\ud83d\udfe2 Status:"}),(0,r.jsx)("span",{style:{color:"#28a745",marginLeft:"10px"},children:"Operational"})]}),(0,r.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,r.jsx)("strong",{children:"\ud83d\udd50 Last Update:"}),(0,r.jsx)("span",{style:{marginLeft:"10px"},children:(new Date).toLocaleString()})]}),(0,r.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,r.jsx)("strong",{children:"\ud83d\udee1\ufe0f Protection Level:"}),(0,r.jsx)("span",{style:{color:"#007bff",marginLeft:"10px"},children:"Maximum"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"\ud83d\udd0d Monitoring:"}),(0,r.jsx)("span",{style:{color:"#28a745",marginLeft:"10px"},children:"Active"})]})]})]})]})]}),"alerts"===m&&(0,r.jsxs)("div",{className:l.alerts.length>0?"alerts-section danger":"alerts-section safe",children:[(0,r.jsxs)("h3",{children:["\ud83d\udea8 Security Alerts (",l.alerts.length,")"]}),0===l.alerts.length?(0,r.jsx)("div",{className:"alert alert-success",children:"\u2705 No active security alerts. System is secure."}):(0,r.jsx)("div",{children:l.alerts.map(e=>(0,r.jsx)(d,{alert:e,onResolve:()=>w(e.id)},e.id))})]}),"tampering"===m&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{children:["\ud83d\udd04 Document Modification Analysis (",j.length,")"]}),0===j.length?(0,r.jsx)("div",{className:"alert alert-info",children:"\ud83d\udcdd No document modifications detected."}):(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{style:{marginBottom:"20px",padding:"15px",background:"#e7f3ff",borderRadius:"8px"},children:[(0,r.jsx)("h4",{children:"\ud83d\udcca Modification Summary"}),(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Total Modifications:"})," ",j.length]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Today:"})," ",j.filter(e=>new Date(e.timestamp).toDateString()===(new Date).toDateString()).length]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"High Impact:"})," ",j.filter(e=>JSON.parse(e.diff_stats||"{}").change_percentage>50).length]})]})]}),(0,r.jsxs)("table",{className:"table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"\ud83d\udcc4 Document"}),(0,r.jsx)("th",{children:"\ud83d\udc64 Modified By"}),(0,r.jsx)("th",{children:"\ud83d\udcca Changes"}),(0,r.jsx)("th",{children:"\u23f0 Time"}),(0,r.jsx)("th",{children:"\ud83d\udd0d Actions"})]})}),(0,r.jsx)("tbody",{children:j.map(e=>{var t;const s=JSON.parse(e.diff_stats||"{}");return(0,r.jsxs)("tr",{children:[(0,r.jsxs)("td",{children:["\ud83d\udcc4 ",e.document_name]}),(0,r.jsx)("td",{children:e.username}),(0,r.jsx)("td",{children:(0,r.jsxs)("div",{style:{fontSize:"12px"},children:[(0,r.jsxs)("span",{style:{color:"#28a745"},children:["+",s.added_lines||0]})," / ",(0,r.jsxs)("span",{style:{color:"#dc3545"},children:["-",s.removed_lines||0]}),(0,r.jsx)("br",{}),(0,r.jsxs)("small",{children:[(null===(t=s.change_percentage)||void 0===t?void 0:t.toFixed(1))||0,"% changed"]})]})}),(0,r.jsx)("td",{children:new Date(e.timestamp).toLocaleString()}),(0,r.jsx)("td",{children:(0,r.jsx)("button",{className:"btn",style:{fontSize:"12px"},onClick:()=>(async e=>{try{const t=localStorage.getItem("token"),s=await i.A.get(`http://localhost:8000/api/admin/modification-diff/${e.id}`,{headers:{Authorization:`Bearer ${t}`}});v({...e,diffData:s.data})}catch(x){alert("Failed to fetch modification details")}})(e),children:"\ud83d\udd0d View Diff"})})]},e.id)})})]})]}),b&&(0,r.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,r.jsxs)("div",{style:{background:"white",padding:"20px",borderRadius:"8px",maxWidth:"90%",maxHeight:"90%",overflow:"auto"},children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,r.jsx)("h3",{children:"\ud83d\udd04 Document Modification Details"}),(0,r.jsx)("button",{className:"btn btn-danger",onClick:()=>v(null),children:"\u2715 Close"})]}),(0,r.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Document:"})," ",b.document_name]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Modified by:"})," ",b.username]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Time:"})," ",new Date(b.timestamp).toLocaleString()]})]}),b.diffData&&(0,r.jsx)(a,{oldText:b.diffData.old_content,newText:b.diffData.new_content,fileName:b.document_name})]})})]}),"data-leaks"===m&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{children:["\ud83d\udea8 Data Leak Attempts Analysis (",u.length,")"]}),0===u.length?(0,r.jsx)("div",{className:"alert alert-success",children:"\u2705 No data leak attempts detected. Security is strong."}):(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{style:{marginBottom:"20px",padding:"15px",background:"#fff5f5",borderRadius:"8px",border:"1px solid #fed7d7"},children:[(0,r.jsx)("h4",{children:"\ud83d\udea8 Leak Attempt Summary"}),(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Total Attempts:"})," ",u.length]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Blocked:"})," ",u.filter(e=>e.blocked).length]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"High Risk:"})," ",u.filter(e=>e.risk_score>=.8).length]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Today:"})," ",u.filter(e=>new Date(e.timestamp).toDateString()===(new Date).toDateString()).length]})]})]}),(0,r.jsxs)("table",{className:"table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"\ud83d\udc64 User"}),(0,r.jsx)("th",{children:"\ud83c\udfaf Target Dept"}),(0,r.jsx)("th",{children:"\ud83d\udcc4 Document"}),(0,r.jsx)("th",{children:"\ud83c\udfad Action"}),(0,r.jsx)("th",{children:"\ud83d\udcca Risk"}),(0,r.jsx)("th",{children:"\ud83d\udee1\ufe0f Status"}),(0,r.jsx)("th",{children:"\u23f0 Time"})]})}),(0,r.jsx)("tbody",{children:u.map(e=>(0,r.jsxs)("tr",{style:{background:e.risk_score>=.8?"#fff5f5":"transparent"},children:[(0,r.jsx)("td",{children:e.username}),(0,r.jsx)("td",{children:(0,r.jsx)("span",{style:{padding:"2px 6px",background:"#dc3545",color:"white",borderRadius:"4px",fontSize:"12px"},children:e.target_department})}),(0,r.jsx)("td",{children:e.document_name}),(0,r.jsx)("td",{children:(0,r.jsx)("span",{style:{padding:"2px 6px",background:"#ffc107",borderRadius:"4px",fontSize:"12px"},children:e.action_attempted})}),(0,r.jsx)("td",{children:(0,r.jsx)("span",{className:`risk-score ${N(e.risk_score)}`,children:A(e.risk_score)})}),(0,r.jsx)("td",{children:e.blocked?(0,r.jsx)("span",{style:{color:"#28a745"},children:"\ud83d\udee1\ufe0f BLOCKED"}):(0,r.jsx)("span",{style:{color:"#dc3545"},children:"\u26a0\ufe0f ALLOWED"})}),(0,r.jsx)("td",{children:new Date(e.timestamp).toLocaleString()})]},e.id))})]})]})]}),"access"===m&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{children:"\ud83d\udcc8 Recent Access Logs"}),0===l.recent_access.length?(0,r.jsx)("p",{children:"No recent access logs."}):(0,r.jsxs)("table",{className:"table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"\ud83d\udc64 User"}),(0,r.jsx)("th",{children:"\ud83d\udcc4 Document"}),(0,r.jsx)("th",{children:"\ud83c\udfaf Action"}),(0,r.jsx)("th",{children:"\u23f0 Time"}),(0,r.jsx)("th",{children:"\ud83d\udcca Risk Score"}),(0,r.jsx)("th",{children:"\ud83d\udea9 Status"})]})}),(0,r.jsx)("tbody",{children:l.recent_access.map(e=>(0,r.jsxs)("tr",{style:{background:e.anomaly_flag?"#fff3cd":"transparent"},children:[(0,r.jsxs)("td",{children:[e.username," (",e.department,")"]}),(0,r.jsx)("td",{children:e.document_name||"N/A"}),(0,r.jsx)("td",{children:(0,r.jsx)("span",{style:{padding:"2px 6px",borderRadius:"4px",background:"read"===e.action?"#d1ecf1":"upload"===e.action?"#d4edda":e.action.includes("cross_department")?"#f8d7da":"#e2e3e5",color:"read"===e.action?"#0c5460":"upload"===e.action?"#155724":e.action.includes("cross_department")?"#721c24":"#495057"},children:e.action.toUpperCase()})}),(0,r.jsx)("td",{children:new Date(e.timestamp).toLocaleString()}),(0,r.jsx)("td",{children:(0,r.jsxs)("span",{className:`risk-score ${N(e.risk_score)}`,children:[A(e.risk_score)," (",e.risk_score.toFixed(2),")"]})}),(0,r.jsx)("td",{children:e.anomaly_flag?(0,r.jsx)("span",{style:{color:"#dc3545"},children:"\ud83d\udea9 Anomalous"}):(0,r.jsx)("span",{style:{color:"#28a745"},children:"\u2705 Normal"})})]},e.id))})]})]})]})]})]})]})}}}]);
//# sourceMappingURL=229.ca25e0c9.chunk.js.map